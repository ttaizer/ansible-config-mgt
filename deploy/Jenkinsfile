pipeline {
    agent any 
    
    environment {
        ANSIBLE_CONGIG_MGT="{$WORKSPACE}"/deploy/ansible.cfg"
    }
       
    stages {
      stage('Initial CleanUp') {
        steps {
          dir("${WORKSPACE}") {
            deleteDir()
          }           
        }
          }           
          }
        }
      
      stage('Checkout SCM') {
        steps {
          git branch: 'feature/jenkinspipeline-stages', url: 'https://github.com/Livingstone95/ansible-config.git' 
        }
      }

      stage('Preparing Ansible for Execution') {
        steps {
          sh 'echo ${WORKSPACE}'
          sh 'sed -i "3 a roles_path=${WORKSPACE}/roles" ${WORKSPACE}/deploy/ansible.config
        }

    }
 }
